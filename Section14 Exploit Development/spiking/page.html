<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Spiking</title>
</head><body>firstly we need to turn off Windows real time protection because vulnserver is blocked by Windows defender.<br/>
<br/>
<img height="589" src="image.png" width="600"/><br/>
<br/>
<br/>
Now we need to start our vulnserver and immunity debugger as administrator we do that as administrator because immunity debugger can't see vulnserver if it's not started as administrator. Okay why we're running vulnserver as admin because when we get a shell this would be a root shell so to say.<br/>
<br/>
<img src="image 2.png"/><br/>
<br/>
<br/>
it should looks like this.<br/>
<br/>
once we start our immmunity debugger we need to attach vulnserver to it.<br/>
<br/>
go to immunity file &gt; attach &gt; find vulnserver from list and attach it.<br/>
<br/>
<img src="image 3.png"/><br/>
<br/>
it looks like this.<br/>
<br/>
we need to turn that running from highlighted button.<br/>
now we are good to go let's go to our attack machine and connect to vulserver through netcat(vulnserver is running on port 9999 by default and we need to know our victim machine's ip in this case this is my main machine ip.)<br/>
<br/>
<img src="image 4.png"/><br/>
<br/>
in here actually TRUN command is vulnerable and we'll learn how to we find that TRUN itself is vulnerable. For that we're going to do spiking. And we'll actually pick a command for example STATS and then we throw bunch of characters one at a time to STATS and see if we can overflow that buffer that we talked about in the previous lesson. <br/>
If when we overflow the buffer the program crash then we find out that STATS is vulnerable. If it doesn't crash then we'll move on the next one.<br/>
<br/>
<br/>
Now for that we'll use a tool called generic_send_tcp let's look at it and see what is its usage?<br/>
Okay<br/>
<img src="image 6.png"/><br/>
we already know host and port we need to a spike script and specify these SKIPVAR and SKIPSTR parameters which will be 0<br/>
<br/>
TCM has written this spike script already let's look at<br/>
<br/>
<img height="313" src="image 7.png" width="450"/><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<img height="229" src="image 5.png" width="650"/><br/>
<br/>
<img height="228" src="image 8.png" width="700"/><br/>
<br/>
<img height="263" src="image 9.png" width="600"/><br/>
<br/>
we're gonna send all kinds of different characters randomly essentially to try to break this part of the program. <br/>
we'll send this script to victim's machine.<br/>
<br/>
<img src="image 10.png"/><br/>
<br/>
and while this send variables we need to se what happens in immunity debugger.<br/>
<br/>
<img src="image 11.png"/><br/>
there is nothing unusual so this is not looking like vulnerable.<br/>
<br/>
now let's look at TRUN spiking.<br/>
<br/>
TRUN spike script should looks like this <br/>
<img src="image 12.png"/><br/>
<br/>
let's send this and see what happens in immunity.<br/>
<br/>
<br/>
<img src="image 13.png"/><br/>
<br/>
immunity starts blinking immediately.<br/>
<br/>
<img height="510" src="image 14.png" width="900"/><br/>
<br/>
And yes this command is vulnerable.<br/>
<br/>
let's try to start again with previous button.<br/>
<br/>
<img src="image 15.png"/><br/>
<br/>
message is clear i think.<br/>
<br/>
<br/>
<img src="image 16.png"/><br/>
<br/>
we sent a bunch of A and we overwrote EIP and EBP most importantly EIP<br/>
<br/>
<br/>
<br/>
<br/>
Further Reading<br/>
<br/>
(https://resources.infosecinstitute.com/intro-to-fuzzing/)</body></html>